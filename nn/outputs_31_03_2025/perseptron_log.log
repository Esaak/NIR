2025-03-31 20:43:14,733 - __main__ - INFO - Loading data...
2025-03-31 20:43:24,824 - __main__ - INFO - Loaded data from /app/nse/ml/output_19_01_2025_2: X shape=(2322432, 10), y shape=(2322432, 4)
2025-03-31 20:43:35,445 - __main__ - INFO - Loaded data from /app/nse/ml/output_21_03_2025: X shape=(2457600, 10), y shape=(2457600, 4)
2025-03-31 20:43:35,549 - __main__ - INFO - Preprocessing and splitting data...
/app/nse/nn/perseptron_test.py:647: UserWarning: To output multiple subplots, the figure containing the passed axes is being cleared.
  target.hist(bins=50, ax=ax)
/app/nse/nn/perseptron_test.py:647: UserWarning: To output multiple subplots, the figure containing the passed axes is being cleared.
  target.hist(bins=50, ax=ax)
2025-03-31 20:43:40,389 - __main__ - INFO - Initializing model for c_delta_z...
/usr/local/lib/python3.10/dist-packages/torch/optim/lr_scheduler.py:61: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
2025-03-31 20:43:43,599 - __main__ - INFO - Training on: cuda
2025-03-31 20:43:43,599 - __main__ - INFO - Starting training...
2025-03-31 20:44:20,820 - __main__ - INFO - Saved best model with validation loss: 0.0788
2025-03-31 20:49:31,508 - __main__ - INFO - Epoch [10/100], Train Loss: 0.0000, Val Loss: 0.1139, LR: 0.000050
2025-03-31 20:55:20,207 - __main__ - INFO - Epoch [20/100], Train Loss: 0.0000, Val Loss: 0.1241, LR: 0.000013
2025-03-31 20:55:55,172 - __main__ - INFO - Early stopping triggered at epoch 21
2025-03-31 20:55:56,327 - __main__ - INFO - Training history plot saved to ./outputs_29_03_2025/training_history.png
2025-03-31 20:55:56,327 - __main__ - INFO - Evaluating model for c_delta_z...
2025-03-31 20:55:56,369 - __main__ - INFO - Loaded best model with validation loss: 0.07878539711236954
2025-03-31 20:55:56,615 - __main__ - INFO - Initializing model for c_delta_y...
2025-03-31 20:55:56,619 - __main__ - INFO - Training on: cuda
2025-03-31 20:55:56,619 - __main__ - INFO - Starting training...
2025-03-31 20:56:31,892 - __main__ - INFO - Saved best model with validation loss: 4.6332
2025-03-31 21:01:47,506 - __main__ - INFO - Epoch [10/100], Train Loss: 0.0001, Val Loss: 7.2180, LR: 0.000050
2025-03-31 21:07:37,282 - __main__ - INFO - Epoch [20/100], Train Loss: 0.0001, Val Loss: 7.8932, LR: 0.000013
2025-03-31 21:08:12,248 - __main__ - INFO - Early stopping triggered at epoch 21
2025-03-31 21:08:13,495 - __main__ - INFO - Training history plot saved to ./outputs_29_03_2025/training_history.png
2025-03-31 21:08:13,495 - __main__ - INFO - Evaluating model for c_delta_y...
2025-03-31 21:08:13,683 - __main__ - INFO - Loaded best model with validation loss: 4.633214950561523
2025-03-31 21:08:13,913 - __main__ - INFO - Initializing model for c_std_z...
2025-03-31 21:08:13,930 - __main__ - INFO - Training on: cuda
2025-03-31 21:08:13,930 - __main__ - INFO - Starting training...
2025-03-31 21:08:49,089 - __main__ - INFO - Saved best model with validation loss: 0.0934
2025-03-31 21:09:24,322 - __main__ - INFO - Saved best model with validation loss: 0.0584
2025-03-31 21:09:59,912 - __main__ - INFO - Saved best model with validation loss: 0.0398
2025-03-31 21:10:35,678 - __main__ - INFO - Saved best model with validation loss: 0.0336
2025-03-31 21:11:11,210 - __main__ - INFO - Saved best model with validation loss: 0.0306
2025-03-31 21:11:46,799 - __main__ - INFO - Saved best model with validation loss: 0.0295
2025-03-31 21:12:22,247 - __main__ - INFO - Saved best model with validation loss: 0.0286
2025-03-31 21:12:57,538 - __main__ - INFO - Saved best model with validation loss: 0.0281
2025-03-31 21:13:33,480 - __main__ - INFO - Saved best model with validation loss: 0.0279
2025-03-31 21:14:08,961 - __main__ - INFO - Epoch [10/100], Train Loss: 0.0000, Val Loss: 0.0284, LR: 0.000100
2025-03-31 21:20:02,134 - __main__ - INFO - Epoch [20/100], Train Loss: 0.0000, Val Loss: 0.0294, LR: 0.000050
2025-03-31 21:25:19,520 - __main__ - INFO - Early stopping triggered at epoch 29
2025-03-31 21:25:20,409 - __main__ - INFO - Training history plot saved to ./outputs_29_03_2025/training_history.png
2025-03-31 21:25:20,409 - __main__ - INFO - Evaluating model for c_std_z...
2025-03-31 21:25:20,696 - __main__ - INFO - Loaded best model with validation loss: 0.027925504371523857
2025-03-31 21:25:20,926 - __main__ - INFO - Initializing model for c_std_y...
2025-03-31 21:25:20,929 - __main__ - INFO - Training on: cuda
2025-03-31 21:25:20,930 - __main__ - INFO - Starting training...
2025-03-31 21:25:56,545 - __main__ - INFO - Saved best model with validation loss: 0.2891
2025-03-31 21:26:32,121 - __main__ - INFO - Saved best model with validation loss: 0.2376
2025-03-31 21:27:07,694 - __main__ - INFO - Saved best model with validation loss: 0.2303
2025-03-31 21:27:43,261 - __main__ - INFO - Saved best model with validation loss: 0.2268
2025-03-31 21:31:16,025 - __main__ - INFO - Epoch [10/100], Train Loss: 0.0000, Val Loss: 0.2412, LR: 0.000100
2025-03-31 21:37:10,817 - __main__ - INFO - Epoch [20/100], Train Loss: 0.0000, Val Loss: 0.2605, LR: 0.000025
2025-03-31 21:39:32,519 - __main__ - INFO - Early stopping triggered at epoch 24
2025-03-31 21:39:33,377 - __main__ - INFO - Training history plot saved to ./outputs_29_03_2025/training_history.png
2025-03-31 21:39:33,377 - __main__ - INFO - Evaluating model for c_std_y...
2025-03-31 21:39:33,634 - __main__ - INFO - Loaded best model with validation loss: 0.22682814300060272
2025-03-31 21:39:33,687 - __main__ - INFO - Calculating SHAP values for feature importance...
2025-03-31 21:40:23,268 - __main__ - INFO - SHAP summary plot saved to ./outputs_29_03_2025/feature_importance.png
/app/nse/nn/perseptron_test.py:647: UserWarning: To output multiple subplots, the figure containing the passed axes is being cleared.
  target.hist(bins=50, ax=ax)
/app/nse/nn/perseptron_test.py:647: UserWarning: To output multiple subplots, the figure containing the passed axes is being cleared.
  target.hist(bins=50, ax=ax)
2025-03-31 21:40:48,201 - __main__ - INFO - Final Test MSE Loss: 13538.0664
2025-03-31 21:41:12,189 - __main__ - INFO - Model saved to ./outputs_29_03_2025/regression_neural_network.pth
2025-03-31 21:41:12,189 - __main__ - INFO - Finish...
(4517057, 11) (4517057, 4)
Split shapes: train: X(2895184, 11), y(2895184, 4), test: X(901693, 11), y(901693, 4), valid: X(720180, 11), y(720180, 4)
                mse        r2      rmse
c_delta_z  0.087582  0.713154  0.295942
c_delta_y  4.806575  0.218567  2.192390
c_std_z    0.029618  0.960088  0.172099
c_std_y    0.227281  0.922399  0.476740
                   mse        r2       rmse
c_delta_z   906.194709  0.704419  30.103068
c_delta_y  1410.726321  0.049877  37.559637
c_std_z     179.993665  0.919148  13.416172
c_std_y     264.922563  0.920565  16.276442
